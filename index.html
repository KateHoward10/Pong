<!DOCTYPE html>
<html>
	<head>
		<title>Pong!</title>
	</head>
	<body>
		<svg id="game" width="800" height="600">
			<rect id="player1" width="10" height="50" x="20" y="275" />
			<rect id="ball" width="10" height="10" x="395" y="295" />
			<rect id="player2" width="10" height="50" x="770" y="275" />
		</svg>
		<script type="text/javascript">
			const game = document.getElementById('game');
			const player1 = document.getElementById('player1');
			const ball = document.getElementById('ball');
			const player2 = document.getElementById('player2');

			function movePlayer2(event) {
				if (event.keyCode === 38) {
					player2.setAttribute('y', +player2.getAttribute('y') - 20);
				} else if (event.keyCode === 40) {
					player2.setAttribute('y', +player2.getAttribute('y') + 20);
				} else if (event.keyCode === 32) {
					ballMove();
				}
			}

			let direction = 'right';
			let yOffset = (Math.random() * 10) - 5;

			function resetGame() {
				ball.setAttribute('x', 395);
				ball.setAttribute('y', 295);
			}

			function ballMove() {
				const currentX = +ball.getAttribute('x');
				const currentY = +ball.getAttribute('y');
				const player2X = +player2.getAttribute('x');
				const player2Y = +player2.getAttribute('y');
				if (currentX + 10 >= player2X && player2Y <= currentY && currentY <= player2Y + 50) {
					direction = 'left';
				}
				if (currentX + 10 >= 800) {
					setTimeout(resetGame, 100);
				}
				if (currentX <= +player1.getAttribute('x') + 10) {
					direction = 'right';
				}

				if (currentY <= 10 || currentY >= 590) {
					yOffset = -1 * yOffset;
				}

				ball.setAttribute('y', currentY + yOffset);
				if (direction === 'left') {
					ball.setAttribute('x', currentX - 2);
				} else {
					ball.setAttribute('x', currentX + 2);
				}
				requestAnimationFrame(ballMove);
			}

			document.addEventListener('keydown', movePlayer2);
		</script>
	</body>
</html>
